<template>
  <div
    id="annotated-timeline"
    class="section"
  >
    <a id="timeline-anchor" />
    <div id="newTimeline">
      <svg
        id="timeline"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 485.75 125.79"
      >
            
        <path
          fill="#efefef"
          d="M4.21 122.76H7v.32H4.21zM7.95 122.76h2.79v.32H7.95zM11.69 122.76h2.79v.32h-2.79zM15.44 122.76h2.79v.32h-2.79zM19.18 122.69h2.79v.4h-2.79zM22.92 122.37h2.79v.72h-2.79zM26.66 122.21h2.79v.88h-2.79zM30.4 122.13h2.79v.95H30.4zM34.14 121.97h2.79v1.11h-2.79zM37.88 121.89h2.79v1.19h-2.79zM41.62 121.73h2.79v1.35h-2.79zM45.36 121.57h2.79v1.51h-2.79zM49.1 121.25h2.79v1.83H49.1z"
        />
        <path
          id="yr_1904"
          class="highlight"
          d="M52.84 120.62h2.79v2.47h-2.79z"
        />
        <path
          fill="#efefef"
          d="M56.58 119.98h2.79v3.1h-2.79zM60.32 119.82h2.79v3.26h-2.79zM64.06 120.14h2.79v2.94h-2.79zM67.8 119.5h2.79v3.58H67.8zM71.54 119.18h2.79v3.9h-2.79zM75.28 118.31h2.79v4.77h-2.79zM79.02 116.88h2.79v6.21h-2.79zM82.76 115.44h2.79v7.64h-2.79zM86.5 115.36h2.79v7.72H86.5zM90.24 114.57h2.79v8.51h-2.79zM93.98 114.01h2.79v9.07h-2.79zM97.72 113.61h2.79v9.47h-2.79zM101.46 113.69h2.79v9.39h-2.79zM105.2 113.93h2.79v9.15h-2.79zM108.94 113.61h2.79v9.47h-2.79zM112.68 112.98h2.79v10.11h-2.79zM116.42 112.42h2.79v10.66h-2.79zM120.16 110.91h2.79v12.18h-2.79zM123.9 110.19h2.79v12.89h-2.79zM127.64 109.48h2.79v13.61h-2.79zM131.38 108.84h2.79v14.24h-2.79zM135.12 108.2h2.79v14.88h-2.79zM138.86 107.8h2.79v15.28h-2.79zM142.6 106.93h2.79v16.15h-2.79z"
        />
        <path
          id="yr1929"
          class="highlight"
          d="M146.34 104.14h2.79v18.94h-2.79z"
        />
        <path
          fill="#efefef"
          d="M150.08 101.6h2.79v21.49h-2.79zM153.82 99.69h2.79v23.4h-2.79zM157.56 99.61h2.79v23.48h-2.79zM161.3 99.53h2.79v23.55h-2.79zM165.04 99.77h2.79v23.32h-2.79zM168.78 98.49h2.79v24.59h-2.79zM172.52 97.7h2.79v25.39h-2.79zM176.26 96.74h2.79v26.34h-2.79zM180 94.75h2.79v28.33H180zM183.74 91.65h2.79v31.43h-2.79zM187.48 86.88h2.79v36.21h-2.79zM191.22 84.57h2.79v38.52h-2.79zM194.96 83.69h2.79v39.39h-2.79zM198.7 82.18h2.79v40.9h-2.79zM202.44 80.59h2.79v42.49h-2.79zM206.18 78.6h2.79v44.48h-2.79zM209.92 76.61h2.79v46.47h-2.79zM213.66 74.46h2.79v48.62h-2.79zM217.4 73.27h2.79v49.82h-2.79zM221.14 71.44h2.79v51.65h-2.79zM224.88 69.77h2.79v53.32h-2.79zM228.62 68.02h2.79v55.07h-2.79zM232.36 66.26h2.79v56.82h-2.79zM236.1 65.39h2.79v57.69h-2.79zM239.84 65.71h2.79v57.38h-2.79zM243.58 64.91h2.79v58.17h-2.79zM247.32 64.67h2.79v58.41h-2.79zM251.06 63.88h2.79v59.21h-2.79zM254.8 62.21h2.79v60.88h-2.79zM258.54 61.65h2.79v61.43h-2.79zM262.28 60.22h2.79v62.87h-2.79zM266.02 57.83h2.79v65.25h-2.79zM269.76 56.8h2.79v66.29h-2.79zM273.5 55.68h2.79v67.4h-2.79zM277.24 53.37h2.79v69.71h-2.79zM280.99 51.3h2.79v71.78h-2.79zM284.73 49.71h2.79v73.37h-2.79zM288.47 47.72h2.79v75.36h-2.79z"
        />
            
        <path
          fill="#efefef"
          d="M318.39 52.74h2.79v70.35h-2.79zM322.13 52.1h2.79v70.98h-2.79zM325.87 51.54h2.79v71.54h-2.79z"
        />

        <path
          fill="#efefef"
          d="M355.79 59.26h2.79v63.82h-2.79zM359.53 59.18h2.79v63.9h-2.79zM363.27 60.14h2.79v62.95h-2.79zM367.01 59.82h2.79v63.26h-2.79zM370.75 58.63h2.79v64.46h-2.79zM374.49 58.78h2.79v64.3h-2.79z"
        />
        <g
          id="era_1990s"
          fill="#efefef"
        >
          <path d="M378.23 58.47h2.79v64.62h-2.79zM381.97 59.26h2.79v63.82h-2.79zM385.71 59.74h2.79v63.34h-2.79zM389.45 59.5h2.79v63.58h-2.79zM393.19 60.77h2.79v62.31h-2.79zM396.93 61.49h2.79v61.59h-2.79z" />
        </g>
        <path
          fill="#efefef"
          d="M400.67 61.33h2.79v61.75h-2.79z"
        />
            
        <path
          fill="#efefef"
          d="M408.15 59.66h2.79v63.42h-2.79zM411.89 58.15h2.79v64.94h-2.79zM415.63 56.72h2.79v66.37h-2.79zM419.37 54.33h2.79v68.75h-2.79zM423.11 53.05h2.79v70.03h-2.79zM426.85 52.82h2.79v70.27h-2.79zM430.59 53.61h2.79v69.47h-2.79zM434.33 52.42h2.79v70.66h-2.79zM438.07 52.26h2.79v70.82h-2.79zM441.81 50.27h2.79v72.81h-2.79zM445.55 49.71h2.79v73.37h-2.79zM449.29 49.16h2.79v73.93h-2.79zM453.03 48.36h2.79v74.72h-2.79zM456.77 47.88h2.79v75.2h-2.79zM460.51 47.17h2.79v75.92h-2.79zM464.25 47.25h2.79v75.84h-2.79zM467.99 46.13h2.79v76.95h-2.79zM471.73 45.73h2.79v77.35h-2.79zM475.47 45.89h2.79v77.19h-2.79zM479.21 43.82H482v79.26h-2.79zM482.95 43.51h2.79v79.58h-2.79z"
        />
           
        <path
          id="yr_1989"
          class="highlight"
          d="M.47 122.84h2.79v.24H.47z"
        />
        <path
          id="yr1998"
          fill="#efefef"
          d="M404.41 60.69h2.79v62.39h-2.79z"
        />
        <g
          id="era_1970s"
          class="highlight"
        >
          <path d="M329.61 51.46h2.79v71.62h-2.79zM333.35 51.3h2.79v71.78h-2.79zM337.09 51.38h2.79v71.7h-2.79zM340.83 51.7h2.79v71.38h-2.79zM344.57 56.24h2.79v66.85h-2.79zM348.31 58.55h2.79v64.54h-2.79zM352.05 59.66h2.79v63.42h-2.79z" />
        </g>
        <g
          id="era_1960s"
          class="highlight"
        >
          <path d="M292.21 47.01H295v76.08h-2.79zM295.95 47.88h2.79v75.2h-2.79zM299.69 48.44h2.79v74.64h-2.79zM303.43 49.79h2.79v73.29h-2.79zM307.17 51.94h2.79v71.14h-2.79zM310.91 52.58h2.79v70.51h-2.79zM314.65 53.77h2.79v69.31h-2.79z" />
        </g>
        <g id="yr_1995">
          <path
            class="highlight"
            d="M393.19 60.77h2.79v62.31h-2.79z"
          />
        </g>

        <g id="annotations-arrows-up">
          <g>
            <path
              transform="translate(-10, 0)"
              d="M410.49 55.65a71.7 71.7 0 0113.1-4.52c3.37-.79 6.82-1.25 10.23-1.82 9.61-1.62 19.3-3.28 28.77-5.6a97.54 97.54 0 0016.11-5.52c.69-.3.1-1.3-.58-1-9 3.93-18.31 6.08-27.87 8q-7.74 1.51-15.51 2.83c-3.64.62-7.32 1.1-10.93 1.9a72.06 72.06 0 00-13.91 4.76c-.68.31-.09 1.31.59 1z"
            />
            <path
              transform="translate(-10, 0)"
              d="M475.9 36.65c.93.49 1.87 1 2.83 1.36l-.21-.79-1.83 2.63a.61.61 0 00.21.8.6.6 0 00.8-.21l1.83-2.63a.59.59 0 00-.21-.8c-1-.41-1.91-.87-2.83-1.37a.6.6 0 00-.8.21.61.61 0 00.21.8z"
            />
          </g>
          <path
            d="M333.2 46.79a31.91 31.91 0 0112.37 3 35.65 35.65 0 014.43 2.48c.57.39 1.14.8 1.69 1.22a3.24 3.24 0 001.87.88.64.64 0 00.62-.82c-.35-.95-.7-1.91-1.06-2.87a4.09 4.09 0 00-.45-1c-.37-.45-1.1-.06-1.11.46a3.49 3.49 0 00.31 1.09c.34 1 .7 2.05 1.05 3.08l.63-.83h-4.35a.65.65 0 000 1.3h4.34a.65.65 0 00.62-.82l-1-2.89c-.08-.23-.15-.47-.23-.71s-.09-.49-.09-.22l-1.11.46c-.16-.2-.05-.08 0 .07a5.1 5.1 0 00.28.74c.31.83.62 1.66.92 2.49l.63-.82a3.66 3.66 0 01-1.51-.93c-.6-.45-1.21-.88-1.84-1.29a33.22 33.22 0 00-17-5.37c-.84 0-.84 1.27 0 1.3zM296 42.72a67.53 67.53 0 019.51 2.09c1.73.52 3.45 1.11 5.14 1.77.81.32 1.62.66 2.42 1a3.66 3.66 0 002 .58.62.62 0 00.52-.91l-1.5-3.45c-.26-.62-1.35-.17-1.09.46.52 1.31 1 2.61 1.55 3.91l.42-.74-3.7 1.11c-.73.23-.42 1.39.32 1.16l3.7-1.11a.61.61 0 00.42-.74L314.19 44l-1.09.47 1.5 3.45.51-.9c-.77.09-1.63-.53-2.33-.83s-1.41-.58-2.12-.86a62.44 62.44 0 00-5-1.69 66.48 66.48 0 00-9.34-2c-.76-.11-1.09 1-.32 1.16z"
          />
          <g>
            <path d="M154 96.18a82.72 82.72 0 0027.71-8.82c4-2.15 7.87-4.66 11.84-6.93s7.77-4.2 11.79-6a144.76 144.76 0 0117.1-6.43c.82-.25.47-1.55-.36-1.29a142.71 142.71 0 00-26.72 11.19c-4.17 2.27-8.15 4.85-12.27 7.19a79.8 79.8 0 01-14.38 6.35 86 86 0 01-15 3.44c-.85.12-.49 1.41.36 1.3z" />
            <path d="M218.86 65.72c1.26.65 2.56 1.19 3.82 1.84l-.24-.92a30.9 30.9 0 00-1.9 3.12.67.67 0 001.16.67 31.9 31.9 0 011.9-3.11.68.68 0 00-.24-.92c-1.26-.65-2.57-1.19-3.82-1.84a.7.7 0 00-.92.24.67.67 0 00.24.92z" />
          </g>
          <g>
            <path d="M63 116.53q25.31-4.31 50.85-7c.58-.06.59-1 0-.92q-25.65 2.69-51.09 7c-.58.1-.34 1 .24.89z" />
            <path d="M110.87 107.47c.93.75 2 1.23 2.95 2v-.65a14.15 14.15 0 01-1 1l-.24.19h-.07l-.17.13-1 .7a.47.47 0 00-.16.63.45.45 0 00.62.16c.56-.39 1.12-.77 1.64-1.21a13 13 0 001-1 .46.46 0 000-.65c-.92-.75-2-1.23-3-2a.46.46 0 10-.65.65z" />
          </g>
        </g>
        <g id="annotations-text">
          <text transform="translate(70 40)">
            1929:<tspan
              x="28"
              y="0"
              font-weight="400"
            >Establishment of USGS Cooperative Program
              <tspan
                x="20.04"
                y="10"
              >fuels investment in hydrological infrastructure</tspan></tspan>
          </text>
          <text
            transform="translate(270 8)"
            class="callouts"
          >
            1960s:<tspan
              x="32"
              y="0"
              font-weight="400"
            >Budget cuts &amp; 
              <tspan
                x="20"
                y="10"
              >network optimization</tspan></tspan>
          </text>
          <text
            transform="translate(317 34)"
            class="callouts"
          >
            1970s: <tspan
              x="30"
              y="0"
              font-weight="400"
            >Coal-Hydrology
              <tspan
                x="22"
                y="10"
              >Program decline</tspan></tspan>
          </text>
          <text
            transform="translate(400 9)"
            class="callouts"
          >
            1995:<tspan
              x="28"
              y="0"
              font-weight="400"
            >Real-time data
              <tspan
                x="2.85"
                y="10"
              >delivery introduced</tspan></tspan>
          </text>
          <g>
            <text
              transform="translate(.81 77)"
              class="callouts"
            >
              1989:<tspan
                x="28"
                y="0"
                font-weight="400"
              >First USGS gage at
                <tspan
                  x="20.29"
                  y="10"
                >Embudo, NM</tspan></tspan>
            </text>
          </g>
          <g>
            <text
              transform="translate(25.8 103.6)"
              class="callouts"
            >
              1904:<tspan
                x="26"
                y="0"
                font-weight="400"
              > 200+ gages!</tspan>
            </text>
          </g>
        </g>
        <g>
          <path
            d="M11.11 83.46c-4.52 4.48-6.55 11-7.8 17a139.53 139.53 0 00-2.2 20.4c-.06 1.08 1.63 1.08 1.69 0a138.45 138.45 0 012.07-19.6c1.18-5.91 3-12.28 7.44-16.64a.85.85 0 00-1.2-1.2zM56.51 108.36a28.81 28.81 0 00-1.51 3.56 34.89 34.89 0 00-1.34 5.89.88.88 0 00.59 1 .86.86 0 001-.59 34.66 34.66 0 011.31-5.79 23.25 23.25 0 011.44-3.22c.48-1-1-1.83-1.46-.85zM150.46 58.48a25 25 0 00-3 9 137.33 137.33 0 00-.7 15.71c-.1 5.46-.22 10.91-.39 16.36a.85.85 0 001.69 0c.25-8.14.31-16.29.57-24.43.12-3.72.19-7.56 1.29-11.15a23.49 23.49 0 012-4.59c.52-1-.94-1.81-1.46-.86z"
            fill="rgb(138, 139, 138)"
          />
        </g>
      </svg>
    </div>
    <div
      class="usa-accordion usa-accordion--bordered custom-tabbed-accordion"
    >
      <div
        v-for="method in methods.methods"
        :key="method.title + '-1'"
        class="headings"
      >
        <h4 class="usa-accordion__heading">
          <button
            v-if="window.width > 770"
            class="usa-accordion__button"
            aria-expanded="false"
            :aria-controls="method.title"
            @click="trackMethodClick"
          >
            {{ method.title }}
          </button>
          <button
            v-if="window.width <= 770 || $isMobile()"
            class="usa-accordion__button"
            aria-expanded="false"
            :aria-controls="method.title"
            @click="trackMethodClick"
          >
            {{ method.timePeriod }}
          </button>
        </h4>
      </div>
      <div
        v-for="method in methods.methods"
        :key="method.title + '-2'"
        class="content"
      >
        <div
          :id="method.title"
          class="usa-accordion__content usa-prose gage-target"
        >
          <h3
            v-if="window.width > 770"
            class="usa-prose"
          >
            {{ method.timePeriod }}
          </h3>
          <h3
            v-if="window.width <= 770 || $isMobile()"
            class="usa-prose"
          >
            {{ method.title }}
          </h3>
          <p><span v-html="method.method" /></p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
  import methods from '../assets/annotatedTimeline/newTimeline.js';
    export default {
        'name': 'NewTimeline',
        data(){
            return{
                methods: methods.methodContent,
                window: {
                  width: 0,
                  height: 0
                }
            }
        },
        created() {
          window.addEventListener('resize', this.handleResize);
          this.handleResize();
        },
        destroyed() {
          window.removeEventListener('resize', this.handleResize);
        },
        mounted() {
            // This is a fix for the weird USWDS glitch that causes the Methods section accordion menus to be open on page load
            this.closeAccordions();
        },
        methods: {
            handleResize() {
              this.window.width = window.innerWidth;
              this.window.height = window.innerHeight;
              this.closeAccordions();
            },
            closeAccordions() {
              const targetAccordionDivs = document.querySelectorAll('div.gage-target');
              targetAccordionDivs.forEach((div) => {
                div.setAttribute('hidden', '""');
              });
            },
            runGoogleAnalytics(eventName, action, label) {
                this.$ga.set({ dimension2: Date.now() });
                this.$ga.event(eventName, action, label);
            },
            trackMethodClick(event) {
              const methodClicked = 'Method clicked: ' + event.target.innerHTML;
              this.runGoogleAnalytics('method interaction', 'click', methodClicked);
            }
        }
    }
</script>

<style scoped lang="scss">
$chevronLeft: '~@/assets/images/chevron-left.png';
$chevronDown: '~@/assets/images/chevron-down.png';
$stateFill: #e4e4e3;
$white: rgb(255,255,255);
$axis: rgb(100,100,100);
$lightGray:rgb(237,237,237);
$darkGray: rgb(51,51,51);
$brightBlue: rgb(9,98,178);
$usgsGreen: rgb(51,120,53);
$brightYellow: rgb(255,200,51);

#newTimeline{
  margin-top: 100px;
}

.custom-tabbed-accordion {
  display: grid;
  grid-template-columns: 30% 30% 40%;
  button:not([disabled]):focus {
    outline: none;
  }
  .usa-accordion__button {
    background-image: url($chevronDown);
    background-size: 15px 10px;
    background-color:  $brightBlue;
    min-height: 5.5em;
    color: white;
    text-align: center;
  }
  .usa-accordion__button[aria-expanded=false] {
    background-image: url($chevronLeft);
    background-size: 10px 15px;
    background-color: rgb(241, 240, 240);
    color: $darkGray;
    min-height: 5.5em;
  }
  .content {
    grid-column: 1 / 4;
  }
}
#timeline {
    width: 100%;
}
#annotations-arrows-up {
    fill: $brightBlue;
}
#annotations-text {
    color: $darkGray;
    font-size:8px;
    font-weight: 800;
}
.highlight {
  fill: $brightBlue;
    stroke-miterlimit:10; 
    stroke-width:.35px;
    opacity: .8;
}

</style>